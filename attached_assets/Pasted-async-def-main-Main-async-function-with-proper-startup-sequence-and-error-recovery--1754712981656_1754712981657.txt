async def main():
    """Main async function with proper startup sequence and error recovery"""
    logger.info("ğŸš€ Starting Discord Bot...")

    max_connection_retries = 5
    retry_delay = 10  # seconds

    for attempt in range(max_connection_retries):
        try:
            # Test connection first
            logger.info(
                f"ğŸ” Testing connection (attempt {attempt + 1}/{max_connection_retries})..."
            )
            if not await test_bot_connection():
                logger.error("âŒ Bot token validation failed")
                if attempt < max_connection_retries - 1:
                    logger.info(f"â³ Retrying in {retry_delay} seconds...")
                    await asyncio.sleep(retry_delay)
                    continue
                else:
                    return

            # Create startup backup
            await startup_backup()

            # Start the bot
            logger.info("ğŸ¤– Starting Discord bot connection...")
            await bot.start(TOKEN)
            break  # If we get here, bot started successfully

        except discord.LoginFailure:
            logger.error("âŒ Invalid bot token")
            break

        except discord.HTTPException as e:
            logger.error(f"âŒ Discord HTTP error: {e}")
            if attempt < max_connection_retries - 1:
                logger.info(f"â³ Retrying in {retry_delay} seconds...")
                await asyncio.sleep(retry_delay)
                retry_delay *= 2  # Exponential backoff
            else:
                logger.error("âŒ Max retries exceeded")

        except KeyboardInterrupt:
            logger.info("ğŸ›‘ Keyboard interrupt received")
            break

        except Exception as e:
            logger.error(f"âŒ Unexpected bot error: {e}")
            if attempt < max_connection_retries - 1:
                logger.info(f"â³ Retrying in {retry_delay} seconds...")
                await asyncio.sleep(retry_delay)
                retry_delay *= 2
            else:
                logger.error("âŒ Max retries exceeded")

    # Cleanup
    try:
        if not bot.is_closed():
            logger.info("ğŸ›‘ Closing bot connection...")
            await bot.close()
    except:
        pass

    logger.info("ğŸ›‘ Bot shutdown complete")